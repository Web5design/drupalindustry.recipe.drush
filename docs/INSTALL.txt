##############################
Recipes to install the website
##############################

This document deals with project deployment. Aspects which are specific to
development are covered in the :doc:`contribute` page.

************
Requirements
************

The following items are required:

* PHP, version >= 5.2, with the following extensions

  * gd2: choose the one bundled with PHP
  * curl
  * mysqli

* an Apache server with at least:
  
  * PHP support
  * mod_rewrite enabled

* PHP CLI
* a MySQL server and a client, version >= 5.1
* drush, version >= 4.1
* gtar, tar, gunzip or utility of your choice to be able to extract a .tar.gz 
  archive.

Set up your environment so that you can execute the commands listed above in a 
shell. Notice that drush commands may call system commands such as cp or curl, 
so you must be able to launch them as well. Otherwise some drush commands may 
fail. Keep in mind that calls like "../drush/drush" or "/path/to/drush" won't 
work.

Set up the Apache environment so that the Apache's user can execute drush and 
other commands. As an example, this is required by the "brand new install"
procedure, because it executes some drush commands.

******************************
Brand new install from archive
******************************

Get the archive
===============



Push files to server
====================



Log on remote server
====================

 

Extract files
=============



Install files
=============



Temporary change file permissions
=================================



Change website settings via configuration files
===============================================

Notice you can also change them post-installation, but you will need to change
file permissions on the sites/default/settings.php file generated by 
server. So you should edit settings before installation if you are not a 
sudoer. 

Install the website via the CMS administration
==============================================

Change file permissions
=======================

The server's user (such as www-data) must have write permissions on:

* sites/default/files (recursively)

Edit website's system settings
==============================

If you haven't changed them at pre-installation.

Load content
===================



Log in a an administrator and change admin's password
=====================================================



Configure language
==================



Setup cron
==========

 

Cleanup and log off remote server
=================================



**************************************************************
Install from archive and import data from another installation
**************************************************************

Cette procédure est utile pour reproduire une installation sur un autre 
environnement.

Sur l'environnement CIBLE:

* extraire l'archive, en placer le contenu dans htdocs/

Sur l'environnement SOURCE :

* dire à l'équipe CMS d'arrêter la saisie pour s'assurer de la conversation 
  des données ;
* vider les caches du site (via la commande système "drush cc all" ;
* réaliser un export de la base de données (un mysqldump standard fonctionne) ;
* exporter les fichiers sites/default/settings.php, 
  sites/default/settings.system.php et l'arborescence 
  fichiers sites/default/files.

Sur l'environnement CIBLE :

* importer l'export de la base de données ;
* importer les fichiers sites/default/settings.php et 
  sites/default/settings.system.php. Les adapter (dans le premier, la
  configuration à la base de données, dans le deuxième, les paramètres des
  Web-Services et du serveur de médias notamment) ;
* importer l'arborescence de fichiers sites/default/files/
* suivre la procédure du chapitre précédent pour différents réglages :

  * configurer la crontab ;
  * configurer le CDN et les serveurs de média ;
  * modifier les permissions sur les fichiers ;
  
* changer si nécessaire le mot de passe administrateur CMS ;
* vider les caches (via la commande systeme "drush cc all").
