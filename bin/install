#!/usr/bin/env bash

# Deploy the distribution.
# Should be a sub-command like bin/distribution install

# Initialize working directory variable
DISTRIBUTION_BASE_DIR="$(dirname $(readlink -f ${BASH_SOURCE[0]}))"
DISTRIBUTION_BASE_DIR="$(dirname $DISTRIBUTION_BASE_DIR)"

PREVIOUS_PWD=$(pwd)

cd $DISTRIBUTION_BASE_DIR

# Read distribution configuration file(s)

# Create DB

# Build Drupal project
cd www
../bin/drush make $DISTRIBUTION_BASE_DIR/etc/distribution.make ./
cd ..

# Prepare settings.php

# Install site
#bin/drush site-install

cd $PREVIOUS_PWD
